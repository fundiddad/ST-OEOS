# OEOScript å‘½ä»¤å‚è€ƒæ–‡æ¡£

æœ¬æ–‡æ¡£æ—¨åœ¨è¯¦ç»†ä»‹ç» OEOScript æ ¼å¼çš„è¯­æ³•ã€å‘½ä»¤å’Œæ‰€æœ‰å¯ç”¨å‚æ•°ã€‚

## ç›®å½•
1.  [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
2.  [æ•°æ®ç±»å‹ä¸è¡¨è¾¾å¼](#æ•°æ®ç±»å‹ä¸è¡¨è¾¾å¼)
3.  [æ˜¾ç¤ºä¸äº¤äº’å‘½ä»¤](#æ˜¾ç¤ºä¸äº¤äº’å‘½ä»¤)
    *   [`say`](#say---æ˜¾ç¤ºå¯¹è¯)
    *   [`image`](#image---æ˜¾ç¤ºå›¾ç‰‡)
    *   [`choice`](#choice---æä¾›é€‰é¡¹)
    *   [`prompt`](#prompt---ç”¨æˆ·è¾“å…¥)
    *   [`audio`](#audio---éŸ³é¢‘æ’­æ”¾)
    *   [`notification`](#notification---æ˜¾ç¤ºé€šçŸ¥)
    *   [`timer`](#timer---è®¡æ—¶å™¨)
4.  [é€»è¾‘ä¸æ§åˆ¶å‘½ä»¤](#é€»è¾‘ä¸æ§åˆ¶å‘½ä»¤)
    *   [`if` / `else if` / `else`](#if--else-if--else---æ¡ä»¶åˆ¤æ–­)
    *   [`goto`](#goto---é¡µé¢è·³è½¬)
    *   [`eval`](#eval---æ‰§è¡Œä»£ç )
    *   [`storage` å‘½ä»¤](#storage-å‘½ä»¤)
    *   [`enable` / `disable`](#enable--disable---é¡µé¢çŠ¶æ€æ§åˆ¶)
    *   [`noop`](#noop---ç©ºæ“ä½œ)
5.  [é«˜çº§ä¸»é¢˜](#é«˜çº§ä¸»é¢˜)
    *   [ä¸ `Sound` å¯¹è±¡äº¤äº’](#ä¸-Sound-å¯¹è±¡äº¤äº’)
    *   [æ¨¡æ‹ŸçŠ¶æ€æ ](#æ¨¡æ‹ŸçŠ¶æ€æ )


---
## æ ¸å¿ƒæ¦‚å¿µ

### 1. é¡µé¢ (Pages)
*   æ¯ä¸ªé¡µé¢å—ä»¥ `>`  å¼€å¤´ï¼Œåè·Ÿå”¯ä¸€çš„é¡µé¢ID,ä»¥`---`ç»“æŸã€‚
*   é¡µé¢å—å†…çš„æ‰€æœ‰åç»­ç¼©è¿›è¡Œéƒ½å±äºè¯¥é¡µé¢ã€‚

**ç¤ºä¾‹:**
```
> start
  say "è¿™æ˜¯èµ·å§‹é¡µ"
---
> page2
  say "è¿™æ˜¯ç¬¬äºŒé¡µ"
---
```

### 2. å‘½ä»¤ (Commands)
*   å‘½ä»¤æ˜¯æ„æˆé¡µé¢çš„åŸºæœ¬æŒ‡ä»¤ï¼Œæ¯è¡Œä¸€ä¸ªã€‚
*   **ä¸»è¦è¯­æ³• (å‘½åå‚æ•°)**: `commandName key1: value1 key2: value2 ...`
    *   æ‰€æœ‰å‚æ•°éƒ½å¸¦æœ‰åç§°ï¼Œä¸ä¼šäº§ç”Ÿæ··æ·†ã€‚
*   **å¿«æ·è¯­æ³• (ä½ç½®å‚æ•°)**: `commandName <value>`
    *   éƒ¨åˆ†å¸¸ç”¨å‘½ä»¤çš„**ç¬¬ä¸€ä¸ªæ ¸å¿ƒå‚æ•°**å¯ä»¥çœç•¥å…¶åç§°ã€‚

> **æ”¯æŒå¿«æ·è¯­æ³•çš„å‘½ä»¤åˆ—è¡¨**
>
> ä»¥ä¸‹å‘½ä»¤çš„é¦–ä½å‚æ•°å¯ä»¥çœç•¥å…³é”®å­—ï¼š
> *   `say <label>` (ç­‰åŒäº `say label: <label>`)
> *   `image <url>` (ç­‰åŒäº `image url: <url>`)
> *   `audio <url>` (ç­‰åŒäº `audio url: <url>`)
> *   `goto <pageId>` (ç­‰åŒäº `goto pageId: <pageId>`)
> *   `storage.remove <key>` (ç­‰åŒäº `storage.remove key: <key>`)
> *   `enable <pageId>` (ç­‰åŒäº `enable pageId: <pageId>`)
> *   `disable <pageId>` (ç­‰åŒäº `disable pageId: <pageId>`)
>
> **é™¤ä»¥ä¸Šåˆ—è¡¨å¤–ï¼Œæ‰€æœ‰å…¶ä»–å‘½ä»¤åŠå…¶å‚æ•°éƒ½å¿…é¡»ä½¿ç”¨å‘½åå‚æ•°è¯­æ³•ã€‚**
> **å¯¹äºæ”¯æŒå¿«æ·è¯­æ³•çš„å‘½ä»¤å¿…é¡»ä½¿ç”¨å¿«æ·è¯­æ³•ã€‚**


### 3. ç¼©è¿›ä¸ä»£ç å—
*   OEOScript v4 ä½¿ç”¨ç¼©è¿›ï¼ˆIndentationï¼‰æ¥å®šä¹‰ä»£ç å—çš„å±‚çº§ç»“æ„ï¼Œç±»ä¼¼äº Pythonã€‚
*   **æ ‡å‡†ç¼©è¿›**: å¿…é¡»ä½¿ç”¨ **2ä¸ªç©ºæ ¼** è¿›è¡Œç¼©è¿›ã€‚è¯·å‹¿ä½¿ç”¨ Tab å­—ç¬¦æˆ–æ··åˆä½¿ç”¨ç©ºæ ¼å’Œ Tabã€‚
*   **å¼ºåˆ¶æ€§**: ç¼©è¿›åœ¨ `if`, `choice`, `notification.create` ç­‰åŒ…å«å­å‘½ä»¤å—çš„å‘½ä»¤ä¸­æ˜¯ **å¼ºåˆ¶æ€§** çš„ï¼Œé”™è¯¯çš„ç¼©è¿›å°†å¯¼è‡´è„šæœ¬è§£æå¤±è´¥ã€‚

---
## æ•°æ®ç±»å‹ä¸è¡¨è¾¾å¼

### 1. å­—ç¬¦ä¸² (String)
*   ä½¿ç”¨åŒå¼•å· `"` åŒ…è£¹ã€‚
*   ç¤ºä¾‹: `say "ä½ å¥½, ä¸–ç•Œ"`

### 2. æ•°å­— (Number) & å¸ƒå°”å€¼ (Boolean)
*   ç›´æ¥ä¹¦å†™ï¼Œæ— éœ€å¼•å·ã€‚
*   ç¤ºä¾‹: `storage.set key: "age" value: 25`
*   ç¤ºä¾‹: `say "ä½ å¥½" skip: true`

### 3. è¡¨è¾¾å¼ (Expressions)
OEOScript ä¾èµ–è¡¨è¾¾å¼æ¥å®ç°åŠ¨æ€çš„æ¸¸æˆé€»è¾‘ã€‚

*   **`$` å‰ç¼€è¡¨è¾¾å¼**: ä»¥å•ä¸ªç¾å…ƒç¬¦å· `$` å¼€å¤´çš„å­—ç¬¦ä¸²è¢«è§†ä¸ºä¸€æ®µå®Œæ•´çš„ JavaScript ä»£ç ã€‚å…¶æ‰§è¡Œç»“æœå°†ä½œä¸ºå‚æ•°çš„æœ€ç»ˆå€¼ã€‚
*   **`<eval>` å†…åµŒè¡¨è¾¾å¼**: åœ¨å­—ç¬¦ä¸²å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨ `<eval>...</eval>` æ ‡ç­¾æ¥åµŒå…¥å¹¶æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ï¼Œå¹¶å°†å…¶ç»“æœæ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚



**ç¤ºä¾‹:**
```
# ä½¿ç”¨ $ å‰ç¼€
storage.set key: "gold" value: $storage.get('gold') - 10
goto $nextPage

# åœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨ <eval>
say "ä½ çš„åˆ†æ•°æ˜¯ <eval>score * 100</eval> åˆ†ã€‚"
say "ä½ å¥½, <eval>storage.get('playerName')</eval>!"
```

> **é‡è¦ï¼šJavaScript è¡¨è¾¾å¼è¯­æ³•é™åˆ¶**
>
> OEOScript v4 ä¸­æ‰€æœ‰çš„ `$` å‰ç¼€è¡¨è¾¾å¼ã€`<eval>` å†…åµŒè¡¨è¾¾å¼ä»¥åŠ `eval` å‘½ä»¤å—éƒ½å¿…é¡»ä¸¥æ ¼éµå¾ª **ECMAScript 5 (ES5)** è¯­æ³•ã€‚
> *   **è¯·ä½¿ç”¨ `var`** å£°æ˜å˜é‡ï¼Œ**ç¦æ­¢**ä½¿ç”¨ `let` å’Œ `const`ã€‚
> *   **è¯·ä½¿ç”¨ `function() {}`** å½¢å¼çš„å‡½æ•°ï¼Œ**ç¦æ­¢**ä½¿ç”¨ç®­å¤´å‡½æ•° `() => {}`ã€‚
>
> è¿èƒŒæ­¤è§„åˆ™å°†å¯¼è‡´è„šæœ¬æ‰§è¡Œå¤±è´¥ã€‚

---
## æ˜¾ç¤ºä¸äº¤äº’å‘½ä»¤

### `say` - æ˜¾ç¤ºå¯¹è¯
åœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¸€æ®µæ–‡å­—ã€‚

**è¯­æ³•**: `say "<label>" [key: value ...]`

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `label` | String | æ˜¯ | `""` | **(é¦–ä½å‚æ•°)** è¦æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ã€‚ |
| `mode` | String | å¦ | `"auto"` | æ˜¾ç¤ºæ¨¡å¼: `"auto"`, `"instant"`, `"pause"`ã€‚ |
| `duration`| String/Num | å¦ | `0` | æ˜¾ç¤ºçš„æŒç»­æ—¶é—´ (å¦‚ `5s`, `1000`)ã€‚ |
| `skip` | Boolean | å¦ | `true` | æ˜¯å¦å…è®¸ç”¨æˆ·è·³è¿‡æ‰“å­—æœºæ•ˆæœã€‚ |
| `align` | String | å¦ | `left` | æ–‡æœ¬å¯¹é½æ–¹å¼: `left`, `center`, `right`ã€‚ |

**ç¤ºä¾‹:**
```
> page1
  say "ä½ å¥½, <eval>storage.get('playerName')</eval>ï¼" mode: "instant"
  say label: "è¿™æ˜¯ä¸€ä¸ª<font color='red'>é‡è¦</font>æ¶ˆæ¯ã€‚"
```

### `image` - æ˜¾ç¤ºå›¾ç‰‡
è®¾ç½®é¡µé¢çš„èƒŒæ™¯å›¾ç‰‡ã€‚

**è¯­æ³•**: `image "<url>"`

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `url` | String | æ˜¯ | - | **(é¦–ä½å‚æ•°)** å›¾ç‰‡çš„ URLã€‚æ”¯æŒ `$` è¡¨è¾¾å¼ã€‚ |

**ç¤ºä¾‹:**
```
> start
  image "media/bg1.jpg"
  image url: $storage.get('currentBackground')
```

### `choice` - æä¾›é€‰é¡¹
å‘ç”¨æˆ·æ˜¾ç¤ºä¸€ç»„å¯ç‚¹å‡»çš„é€‰é¡¹ã€‚

**è¯­æ³•**:
```
choice
  "<label>" [when: <condition>] [color: <color>] [keep: <boolean>]
    # è¦æ‰§è¡Œçš„å‘½ä»¤å—
    <commands>
  "<label>" [when: <condition>] [color: <color>] [keep: <boolean>] -> <single_command>
```

**é€‰é¡¹å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `label` | String | æ˜¯ | - | **(é¦–ä½å‚æ•°)** é€‰é¡¹æ˜¾ç¤ºçš„æ–‡æœ¬ã€‚ |
| `when` | Expression | å¦ | `true` | (å¯é€‰) æ§åˆ¶é€‰é¡¹æ˜¯å¦å¯è§çš„JSæ¡ä»¶è¡¨è¾¾å¼ã€‚ |
| `color` | String | å¦ | - | (å¯é€‰) é€‰é¡¹æŒ‰é’®çš„é¢œè‰²ã€‚ |
| `keep` | Boolean | å¦ | `false` | (å¯é€‰) è‹¥ä¸º `true`ï¼Œç‚¹å‡»åé€‰é¡¹åˆ—è¡¨ä¸æ¶ˆå¤±ã€‚ |
| `->` | - | - | - | (å¯é€‰) ç”¨äºå•è¡Œå‘½ä»¤çš„å¿«æ·è¯­æ³•ã€‚ |

**å•è¡Œå‘½ä»¤å¿«æ·æ–¹å¼**
å¦‚æœé€‰é¡¹è¢«ç‚¹å‡»ååªéœ€è¦æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ `->` ç¬¦å·æ¥ç®€åŒ–ä¹¦å†™ï¼Œæ— éœ€ç¼©è¿›ä»£ç å—ã€‚
```
choice
  "ç›´æ¥ç»“æŸ" -> end
  "å»ä¸‹ä¸€é¡µ" -> goto next_page
```

**ç¤ºä¾‹:**
```
> crossroads
  say "ä½ èµ°åˆ°äº†ä¸€ä¸ªåå­—è·¯å£ã€‚"
  choice
    "å‘å·¦èµ°"
      say "ä½ é€‰æ‹©äº†å·¦è¾¹çš„è·¯ã€‚"
      goto forest_path
    "å‘å³èµ°" when: $storage.get('hasMap') == true color: "blue"
      say "ä½ çœ‹ç€åœ°å›¾ï¼Œé€‰æ‹©äº†å³è¾¹ã€‚"
      goto city_path
    "æŸ¥çœ‹çŠ¶æ€" keep: true
      say "ä½ çš„ç”Ÿå‘½å€¼æ˜¯ <eval>storage.get('hp')</eval>"
    "åŸåœ°ç­‰å¾…" -> goto waiting_event
```

### `prompt` - ç”¨æˆ·è¾“å…¥
æ˜¾ç¤ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·è¾“å…¥æ–‡æœ¬ã€‚

**è¯­æ³•**: `prompt var: "<variable_name>" [value: "<initial_value>"]`

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `var` | String | æ˜¯ | - | ç”¨æˆ·è¾“å…¥çš„å€¼å°†è¢«èµ‹ç»™çš„å…¨å±€å˜é‡åã€‚ |
| `value` | String | å¦ | `""` | è¾“å…¥æ¡†çš„åˆå§‹é»˜è®¤å€¼ã€‚ |

> **å·¥ä½œæœºåˆ¶è¯´æ˜**ï¼š`prompt` å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªç”± `var` å‚æ•°æŒ‡å®šçš„ **ä¸´æ—¶å…¨å±€å˜é‡**ï¼ˆä¾‹å¦‚ `playerName`ï¼‰ã€‚è¿™ä¸ªå˜é‡ä»…åœ¨å½“å‰é¡µé¢çš„åç»­å‘½ä»¤æ‰§è¡ŒæœŸé—´æœ‰æ•ˆã€‚ä¸ºäº†é•¿æœŸä¿å­˜ç”¨æˆ·è¾“å…¥ï¼Œä½ å¿…é¡»ç´§æ¥ç€ä½¿ç”¨ `eval` æˆ– `storage.set` å‘½ä»¤å°†å…¶å­˜å…¥ `storage`ï¼Œå¦‚ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹:**
```
> ask_name
  say "ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ"
  prompt var: "playerName" value: "è·¯äººç”²"
  eval code: "storage.set('playerName', playerName)"
  say "ä½ å¥½, <eval>playerName</eval>!"
```

### `audio` - éŸ³é¢‘æ’­æ”¾
æ’­æ”¾ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚

**è¯­æ³•**: `audio.play "<url>" [key: value ...]`

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `url` | String | æ˜¯ | - | **(é¦–ä½å‚æ•°)** éŸ³é¢‘æ–‡ä»¶çš„ URLã€‚ |
| `id` | String | å¦ | `__Sound_`+URL | éŸ³é¢‘çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåç»­æ§åˆ¶ã€‚ |
| `loops` | Number | å¦ | `1` | å¾ªç¯æ’­æ”¾æ¬¡æ•°ã€‚`0` è¡¨ç¤ºæ— é™å¾ªç¯ã€‚ |
| `volume` | Number | å¦ | `1.0` | éŸ³é‡ï¼ŒèŒƒå›´ä» `0` åˆ° `1`ã€‚ |
| `background`| Boolean | å¦ | `false`| æ˜¯å¦ä½œä¸ºèƒŒæ™¯éŸ³ä¹æ’­æ”¾ã€‚ |

**ç¤ºä¾‹:**
```
> battle_scene
  audio.play "media/bgm.mp3" id: "bgm" loops: 0 background: true volume: 0.5
```

### `notification` - æ˜¾ç¤ºé€šçŸ¥
åœ¨å±å¹•è¾¹ç¼˜æ˜¾ç¤ºä¸€ä¸ªçŸ­æš‚æˆ–æŒä¹…çš„é€šçŸ¥ã€‚

**è¯­æ³•**:
```
# åˆ›å»º/æ›´æ–°é€šçŸ¥
notification.create id: "<id>" label: "<text>" [key: value ...]
  # (å¯é€‰) ç‚¹å‡»æŒ‰é’®æ—¶æ‰§è¡Œçš„å‘½ä»¤
  commands
    <command_block>
  # (å¯é€‰) è®¡æ—¶ç»“æŸåæ‰§è¡Œçš„å‘½ä»¤
  timerCommands
    <command_block>

# ç§»é™¤é€šçŸ¥
notification.remove "<id>"
```

**`notification.create` å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `id` | String | æ˜¯ | - | é€šçŸ¥çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ |
| `label` | String | æ˜¯ | `""` | é€šçŸ¥çš„å†…å®¹ã€‚æ”¯æŒ `<eval>`ã€‚ |
| `duration` | String/Num | å¦ | - | é€šçŸ¥çš„æŒç»­æ˜¾ç¤ºæ—¶é—´ã€‚è‹¥ä¸æä¾›ï¼Œåˆ™é€šçŸ¥å°†æŒä¹…æ˜¾ç¤ºã€‚ |
| `button` | String | å¦ | `""` | é€šçŸ¥ä¸ŠæŒ‰é’®çš„æ–‡æœ¬ã€‚ |

**`notification.remove` å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `id` | String | æ˜¯ | - | **(é¦–ä½å‚æ•°)** è¦ç§»é™¤çš„é€šçŸ¥çš„IDã€‚ |

**ç¤ºä¾‹:**
```
> show_quest
  notification.create id: "quest" label: "æ–°ä»»åŠ¡ï¼šæ‰¾åˆ°é’¥åŒ™" button: "æ¥å—" duration: "10s"
    commands
      say "ä»»åŠ¡å·²æ¥å—ï¼"
      eval code: "storage.set('quest_accepted', true)"
    timerCommands
      say "ä½ é”™è¿‡äº†æ¥å—ä»»åŠ¡çš„æ—¶é—´ã€‚"

> remove_quest
  notification.remove "quest"
```

### `timer` - è®¡æ—¶å™¨
åˆ›å»ºä¸€ä¸ªå»¶æ—¶ã€å€’è®¡æ—¶æˆ–å‘¨æœŸæ€§äº‹ä»¶ã€‚

**è¯­æ³•**:
```
# åŒæ­¥ï¼ˆé˜»å¡ï¼‰è®¡æ—¶å™¨
timer duration: <duration> [key: value ...]

# å¼‚æ­¥ï¼ˆéé˜»å¡ï¼‰è®¡æ—¶å™¨
timer duration: <duration> [key: value ...]
  <commands>

# ç§»é™¤è®¡æ—¶å™¨
timer.remove id: "<id>"
```

> âš ï¸ **é‡è¦ï¼šåŒæ­¥ vs å¼‚æ­¥æ¨¡å¼**
> `timer` å‘½ä»¤çš„è¡Œä¸ºæ¨¡å¼å–å†³äºå®ƒæ˜¯å¦åŒ…å«å­å‘½ä»¤å—ï¼š
> *   **åŒæ­¥ (é˜»å¡) æ¨¡å¼**: `timer duration: ...`
>     *   å½“ `timer` å‘½ä»¤**ä¸å¸¦**å­å‘½ä»¤å—æ—¶ï¼Œå®ƒä¼šæš‚åœæ•´ä¸ªè„šæœ¬çš„æ‰§è¡Œï¼Œç›´åˆ°è®¡æ—¶ç»“æŸã€‚è¿™é€‚ç”¨äºéœ€è¦ç²¾ç¡®å»¶æ—¶çš„åœºæ™¯ã€‚
> *   **å¼‚æ­¥ (éé˜»å¡) æ¨¡å¼**: `timer duration: ...`
>     *   å½“ `timer` å‘½ä»¤**å¸¦æœ‰**å­å‘½ä»¤å—æ—¶ï¼ˆå³ä½¿å—å†…ä¸ºç©ºï¼‰ï¼Œå®ƒä¼šç«‹å³åœ¨åå°å¼€å§‹è®¡æ—¶ï¼Œå¹¶ä¸”è„šæœ¬ä¼šç»§ç»­æ‰§è¡Œåç»­å‘½ä»¤ï¼Œä¸ä¼šæš‚åœã€‚è¿™é€‚ç”¨äºåˆ›å»ºåå°ä»»åŠ¡æˆ–å€’è®¡æ—¶ã€‚

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `duration` | String/Num | æ˜¯ | - | è®¡æ—¶å™¨æ—¶é•¿ï¼ˆå¦‚ `5s`, `1000`ï¼‰ã€‚ |
| `id` | String | å¦ | `__timer_`+æ•°å­— | è®¡æ—¶å™¨çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºæ§åˆ¶ã€‚ |
| `loops` | Number | å¦ | `1` | å¾ªç¯æ¬¡æ•°ï¼Œ`0` ä¸ºæ— é™å¾ªç¯ã€‚ |
| `style` | String | å¦ | - | ç•Œé¢æ˜¾ç¤ºæ ·å¼ï¼ˆå¦‚ `bar`, `text`ï¼‰ã€‚ |
| `paused` | Boolean | å¦ | `false`| å¦‚æœä¸º `true`ï¼Œè®¡æ—¶å™¨åˆ›å»ºåå°†å¤„äºæš‚åœçŠ¶æ€ã€‚ |
| `commands` | Block | å¦ | `[]` | è®¡æ—¶ç»“æŸæ—¶æ‰§è¡Œçš„å‘½ä»¤å—ã€‚**æ­¤å‚æ•°çš„å­˜åœ¨ä¼šä½¿è®¡æ—¶å™¨å˜ä¸ºå¼‚æ­¥æ¨¡å¼ã€‚** |

**ç¤ºä¾‹:**
```
> sync_timer_example
  say "5ç§’åçˆ†ç‚¸..."
  timer duration: "5s" style: "text"
  say "è½°ï¼"

> async_timer_example
  say "ç‚¸å¼¹å·²å¯åŠ¨ï¼Œä½ åªæœ‰30ç§’ï¼"
  timer duration: "30s" id: "bomb"
    say "æ—¶é—´åˆ°äº†ï¼"
    goto game_over
  
> disarm_bomb
  say "ä½ æˆåŠŸæ‹†é™¤äº†ç‚¸å¼¹ï¼"
  timer.remove id: "bomb"
```

---
## é€»è¾‘ä¸æ§åˆ¶å‘½ä»¤

### `if` / `else if` / `else` - æ¡ä»¶åˆ¤æ–­
æ ¹æ®æ¡ä»¶çš„çœŸå‡æ‰§è¡Œä¸åŒçš„å‘½ä»¤åˆ†æ”¯ã€‚

**è¯­æ³•**:
```
if <condition>
  <commands>
[else if <condition>
  <commands>]
[else
  <commands>]
```
**ç¤ºä¾‹:**
```
if $storage.get('gold') >= 100
  say "ä½ è´­ä¹°äº†å•†å“ã€‚"
else if $storage.get('gold') >= 50
  say "ä½ å¯ä»¥ä¹°ä¸ªä¾¿å®œç‚¹çš„ã€‚"
else
  say "ä½ çš„é‡‘å¸ä¸å¤Ÿã€‚"
```

### `goto` - é¡µé¢è·³è½¬
è·³è½¬åˆ°æŒ‡å®šçš„é¡µé¢ã€‚

**è¯­æ³•**: `goto <pageId>`

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `pageId` | String | æ˜¯ | - | **(é¦–ä½å‚æ•°)** è¦è·³è½¬åˆ°çš„ç›®æ ‡é¡µé¢çš„IDã€‚æ”¯æŒ `$` è¡¨è¾¾å¼ã€‚ |

### `eval` - æ‰§è¡Œä»£ç 
æ‰§è¡Œä¸€æ®µä»»æ„çš„ JavaScript ä»£ç ã€‚

**è¯­æ³•**:
```
# å•è¡Œ
eval code: "<js_code_string>"

# å¤šè¡Œ
eval
  <js_code_line_1>
  <js_code_line_2>
```

**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `code` | String | æ˜¯ | - | è¦æ‰§è¡Œçš„å•è¡Œ JavaScript ä»£ç å­—ç¬¦ä¸²ã€‚ |

> **é‡è¦æç¤º: ES5 è¯­æ³•é™åˆ¶**
>
> `eval` å’Œè¡¨è¾¾å¼ä¸­æ‰§è¡Œçš„ JavaScript ä»£ç å¿…é¡»éµå¾ª **ES5 è¯­æ³•**ã€‚è¯·**é¿å…**ä½¿ç”¨ ES6+ çš„ç‰¹æ€§ï¼Œä¾‹å¦‚ `let`ã€`const` æˆ–ç®­å¤´å‡½æ•° (`=>`)ã€‚è¯·ä½¿ç”¨ `var` æ¥å£°æ˜å˜é‡ã€‚

**ç¤ºä¾‹:**
```
eval code: "var newHp = storage.get('hp') - 10; storage.set('hp', newHp);"

eval
  var currentFavor = storage.get('favor');
  storage.set('favor', currentFavor + 1);
```

### `storage` å‘½ä»¤
ç”¨äºåœ¨æ¸¸æˆçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­æŒä¹…åŒ–å­˜å‚¨å’Œè¯»å–æ•°æ®ã€‚

**`storage.set`**: è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ã€‚
**è¯­æ³•**: `storage.set key: "<key>" value: <value>`

**`storage.remove`**: ç§»é™¤ä¸€ä¸ªé”®å€¼å¯¹ã€‚
**è¯­æ³•**: `storage.remove "<key>"`

**`storage.clear`**: æ¸…é™¤æ‰€æœ‰å­˜å‚¨çš„æ•°æ®ã€‚
**è¯­æ³•**: `storage.clear`

### `enable` / `disable` - é¡µé¢çŠ¶æ€æ§åˆ¶
å¯ç”¨æˆ–ç¦ç”¨æŸä¸ªé¡µé¢ï¼Œæ§åˆ¶å…¶æ˜¯å¦å¯è¢« `goto` è·³è½¬ã€‚

**è¯­æ³•**:
```
enable "<pageId>"
disable "<pageId>"
```
**å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | æè¿° |
| :--- | :--- | :--- | :--- | :--- |
| `pageId` | String | æ˜¯ | - | **(é¦–ä½å‚æ•°)** è¦å¯ç”¨æˆ–ç¦ç”¨çš„ç›®æ ‡é¡µé¢çš„IDã€‚ |


### `noop` - ç©ºæ“ä½œ
ä¸€ä¸ªä¸æ‰§è¡Œä»»ä½•æ“ä½œçš„å‘½ä»¤ï¼Œé€šå¸¸ç”¨ä½œé€»è¾‘å ä½ç¬¦ã€‚

**è¯­æ³•**: `noop`

---
## é«˜çº§ä¸»é¢˜

### ä¸ `Sound` å¯¹è±¡äº¤äº’
æ‰€æœ‰å¯¹éŸ³é¢‘çš„æ’­æ”¾æ§åˆ¶ï¼ˆæš‚åœã€åœæ­¢ã€æ¢å¤ç­‰ï¼‰éƒ½**å¿…é¡»**é€šè¿‡ `eval` å‘½ä»¤ï¼Œè·å– `Sound` å¯¹è±¡å®ä¾‹åè°ƒç”¨å…¶æ–¹æ³•æ¥å®Œæˆã€‚

**å¯ç”¨çš„ `Sound` å¯¹è±¡æ–¹æ³•:**
| æ–¹æ³• | æè¿° |
| :--- | :--- |
| `.play()` | æ’­æ”¾æˆ–æ¢å¤éŸ³é¢‘ã€‚ |
| `.pause()` | æš‚åœéŸ³é¢‘ã€‚ |
| `.stop()` | åœæ­¢éŸ³é¢‘å¹¶å›åˆ°èµ·ç‚¹ã€‚ |

**ç¤ºä¾‹ï¼š**
```
> battle_won
  say "æˆ˜æ–—èƒœåˆ©ï¼"
  eval code: "Sound.get('bgm').stop()"
```

### æ¨¡æ‹ŸçŠ¶æ€æ 
é€šè¿‡åˆ›å»ºä¸€ä¸ª**ä¸ä¼šè‡ªåŠ¨æ¶ˆå¤±**çš„ `notification` æ¥å®ç°ã€‚è¦æ›´æ–°çŠ¶æ€æ ï¼Œåªéœ€ä½¿ç”¨ç›¸åŒçš„ `id` å†æ¬¡è°ƒç”¨ `notification.create`ã€‚

**ç¤ºä¾‹:**
```
> start
  # é¦–æ¬¡åˆ›å»ºçŠ¶æ€æ 
  storage.clear
  storage.set key: "hp" value:100
  storage.set key: "gold" value: 50
  notification.create id: "statusBar" label: "â¤ï¸ HP: <eval>hp</eval> | ğŸ’° é‡‘å¸: <eval>gold</eval>"
  goto encounter

> encounter
  say "ä½ å—åˆ°äº†10ç‚¹ä¼¤å®³ï¼"
  eval code: "hp = hp - 10;"
  # ä½¿ç”¨ç›¸åŒçš„ ID æ›´æ–°çŠ¶æ€æ 
  notification.create id: "statusBar" label: "â¤ï¸ HP: <eval>hp</eval> | ğŸ’° é‡‘å¸: <eval>gold</eval>"
```

